<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sugerencias</title>

<style>
body{margin:0;padding:20px;font-family:Arial;background:#f4f4f4;color:#333}
h1{text-align:center;color:#1a4b27;margin-bottom:20px}
textarea{
    width:100%;padding:12px;border-radius:10px;border:1px solid #ccc;
    font-size:16px;resize:vertical;min-height:80px;margin-bottom:15px
}
.btn{
    width:100%;padding:14px;border:none;border-radius:15px;
    font-size:18px;font-weight:bold;margin-top:5px;cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,0.1)
}
.btn-enviar{background:#2d6a4f;color:white}
.btn-enviar:hover{background:#1f4d37}

.card{
    background:white;padding:15px;margin-bottom:15px;border-radius:15px;
    box-shadow:0 4px 10px rgba(0,0,0,0.1)
}
.card p{margin:5px 0}
.fecha{color:#888;font-size:14px}

.btn-volver{
    position:fixed;left:20px;bottom:20px;
    padding:14px 18px;border-radius:15px;font-size:18px;
    font-weight:bold;border:none;background:white;color:#1a4b27;
    cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.15)
}
.btn-volver:hover{background:#e8e8e8}
</style>

</head>
<body>

<h1>Sugerencias</h1>

<textarea id="textoSugerencia" placeholder="Escribe tu sugerencia aquí..."></textarea>

<button class="btn btn-enviar" onclick="enviarSugerencia()">Enviar Sugerencia</button>

<h2 style="margin-top:25px;color:#1a4b27;">Sugerencias enviadas</h2>
<div id="listaSugerencias"></div>

<button class="btn-volver" onclick="location.href='index.html'">⬅️ Volver</button>

<!-- =========================== -->
<!-- Firebase en tiempo real     -->
<!-- =========================== -->
<script type="module">
import { db, ref, push, set, onValue } from "./firebase.js";

const lista = document.getElementById("listaSugerencias");
const input = document.getElementById("textoSugerencia");

// Enviar sugerencia
function enviarSugerencia(){
    const texto = input.value.trim();
    if(!texto){ alert("Escribe una sugerencia antes de enviar."); return; }

    const fecha = new Date().toLocaleDateString();
    const hora = new Date().toLocaleTimeString();

    const nuevaRef = push(ref(db, "sugerencias"));
    set(nuevaRef, { texto, fecha, hora });

    input.value = "";
    alert("✅ Sugerencia enviada");
}

// Mostrar lista en tiempo real
onValue(ref(db, "sugerencias"), snapshot => {
    const data = snapshot.val();
    lista.innerHTML = "";

    if(!data){
        lista.innerHTML = "<p style='color:#777'>Aún no hay sugerencias.</p>";
        return;
    }

    const arr = Object.values(data).reverse(); // últimas arriba

    arr.forEach(s => {
        const div = document.createElement("div");
        div.className = "card";

        div.innerHTML = `
            <p>${s.texto}</p>
            <p class="fecha">${s.fecha} - ${s.hora}</p>
        `;

        lista.appendChild(div);
    });
});
</script>

</body>
</html>