<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Informar Territorio</title>
<style>
body{margin:0;padding:20px;font-family:Arial;background:#f4f4f4;color:#333}
h1{color:#1a4b27;text-align:center;margin-bottom:20px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}
.card{background:white;padding:18px;border-radius:15px;text-align:center;font-size:18px;font-weight:bold;box-shadow:0 4px 10px rgba(0,0,0,0.1);cursor:pointer;transition:.2s}
.card:hover{transform:scale(1.05)}
.manzanas{display:none;margin-top:20px}
.manzana{background:white;padding:12px;margin-bottom:10px;border-radius:10px;border:1px solid #ddd;cursor:pointer;font-weight:bold;font-size:17px}
.checked{background:#d8f3dc;border-color:#2d6a4f;color:#2d6a4f}
input,textarea{width:100%;padding:12px;border-radius:10px;border:1px solid #ccc;margin-bottom:12px;box-sizing:border-box;font-size:16px}
textarea{resize:vertical;min-height:60px}
.btn{padding:14px 18px;border-radius:15px;font-size:18px;font-weight:bold;cursor:pointer;border:none;box-shadow:0 4px 10px rgba(0,0,0,0.08);transition:.15s}
.enviar{background:#2d6a4f;color:white;float:right;margin-left:5px}
.enviar:hover{background:#1f4d37}
.volver{background:white;color:#1a4b27;float:left;margin-right:5px}
.volver:hover{background:#e8e8e8}
.clearfix::after{content:"";display:table;clear:both}
</style>
</head>
<body>

<h1>Informar Territorio</h1>

<div id="territoriosGrid" class="grid"></div>

<div id="manzanasSection" class="manzanas"></div>

<div id="formSection" class="manzanas">
    <input type="text" id="nombreHermano" placeholder="Nombre del hermano">
    <textarea id="observaciones" placeholder="Observaciones..."></textarea>
    <div class="clearfix">
        <button class="btn volver" onclick="volverTerritorios()">⬅️ Volver</button>
        <button class="btn enviar" onclick="guardarReporte()">✅ Enviar Informe</button>
    </div>
</div>

<script>
const territorios = Array.from({length:32},(_,i)=>({
    numero:i+1,
    manzanas:["A","B","C","D","E"] 
}));

const grid=document.getElementById("territoriosGrid");
const manzanasSection=document.getElementById("manzanasSection");
const formSection=document.getElementById("formSection");
let territorioSeleccionado=null;

function renderTarjetas(){
    grid.innerHTML="";
    territorios.forEach(t=>{
        const card=document.createElement("div");
        card.className="card";
        card.textContent=`Territorio ${t.numero}`;
        card.onclick=()=>abrirTerritorio(t);
        grid.appendChild(card);
    });
}
renderTarjetas();

function abrirTerritorio(t){
    territorioSeleccionado=t;
    grid.style.display="grid";
    manzanasSection.style.display="block";
    formSection.style.display="block";

    manzanasSection.innerHTML=`<h2>Territorio ${t.numero}</h2>`;
    t.manzanas.forEach(m=>{
        const div=document.createElement("div");
        div.className="manzana";
        div.textContent=`Manzana ${m}`;
        div.onclick=()=>div.classList.toggle("checked");
        manzanasSection.appendChild(div);
    });
    window.scrollTo({top:0,behavior:'smooth'});
}

function volverTerritorios(){
    manzanasSection.style.display="none";
    formSection.style.display="none";
    renderTarjetas();
}

function guardarReporte(){
    const nombre=document.getElementById("nombreHermano").value.trim();
    const observaciones=document.getElementById("observaciones").value.trim();
    if(!nombre){alert("Por favor ingrese su nombre.");return;}

    const manzanasDivs=manzanasSection.querySelectorAll(".manzana");
    const hechas=[],pendientes=[];
    manzanasDivs.forEach(div=>{
        const letra=div.textContent.replace("Manzana ","");
        if(div.classList.contains("checked")) hechas.push(letra);
        else pendientes.push(letra);
    });

    const fecha=new Date().toLocaleDateString();
    const reporte={fecha,nombre,territorio:territorioSeleccionado.numero,hechas,pendientes,observaciones};

    const reportesGuardados=JSON.parse(localStorage.getItem("reportes")||"[]");
    reportesGuardados.push(reporte);
    localStorage.setItem("reportes",JSON.stringify(reportesGuardados));

    alert("✅ Informe guardado correctamente.");
    volverTerritorios();
    document.getElementById("nombreHermano").value="";
    document.getElementById("observaciones").value="";
}
</script>
</body>
</html>