<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Informar Territorio</title>
<style>
body{margin:0;padding:20px;font-family:Arial;background:#f4f4f4;color:#333}
h1{color:#1a4b27;text-align:center;margin-bottom:20px}
input{width:100%;padding:12px;border-radius:10px;border:1px solid #ccc;margin-bottom:12px;box-sizing:border-box;font-size:16px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}
.card{background:white;padding:18px;border-radius:15px;text-align:center;font-size:18px;font-weight:bold;box-shadow:0 4px 10px rgba(0,0,0,0.1);cursor:pointer;transition:.2s}
.card:hover{transform:scale(1.05)}
.manzanas-section{display:none;margin-top:20px}
.manzana{background:white;padding:12px;margin-bottom:10px;border-radius:10px;border:1px solid #ddd;cursor:pointer;font-weight:bold;font-size:17px}
.checked{background:#d8f3dc;border-color:#2d6a4f;color:#2d6a4f}
textarea{width:100%;padding:12px;border-radius:10px;border:1px solid #ccc;margin-bottom:12px;box-sizing:border-box;font-size:16px;resize:vertical;min-height:60px}
.btn{padding:14px 18px;border-radius:15px;font-size:18px;font-weight:bold;cursor:pointer;border:none;box-shadow:0 4px 10px rgba(0,0,0,0.08);transition:.15s}
.enviar{background:#2d6a4f;color:white;float:right;margin-left:5px}
.enviar:hover{background:#1f4d37}
.volver{background:white;color:#1a4b27;float:left;margin-right:5px}
.volver:hover{background:#e8e8e8}
.clearfix::after{content:"";display:table;clear:both}
</style>
</head>
<body>

<h1>Informar Territorio</h1>

<input type="text" id="searchInput" placeholder="Buscar territorio por número…">

<div id="territoriosGrid" class="grid"></div>

<div id="manzanasSection" class="manzanas-section"></div>

<div id="formSection" class="manzanas-section">
    <input type="text" id="nombreHermano" placeholder="Nombre del hermano">
    <textarea id="observaciones" placeholder="Observaciones..."></textarea>
    <div class="clearfix">
        <button class="btn volver" onclick="volverTerritorios()">⬅️ Volver</button>
        <button class="btn enviar" onclick="guardarReporte()">✅ Enviar Informe</button>
    </div>
</div>

<script>
const territorios=[
    {numero:1,manzanas:["A","B","C","D"]},
    {numero:2,manzanas:["A","B","C","D"]},
    {numero:3,manzanas:["A","B","C","D"]},
    {numero:4,manzanas:["A","B","C","D","E"]},
    {numero:5,manzanas:["A","B","C","D","E","F","G","H"]},
    {numero:6,manzanas:["A","B","C","D","E","F"]},
    {numero:7,manzanas:["A","B","C","D","E","F"]},
    {numero:8,manzanas:["A","B","C","D","E","F","G"]},
    {numero:9,manzanas:["A","B","C","D","E","F","G","H","I"]},
    {numero:10,manzanas:["A","B","C","D","E","F","G","H","I"]},
    {numero:11,manzanas:["A","B","C","D","E"]},
    {numero:12,manzanas:["A","B","C","D","E","F"]},
    {numero:13,manzanas:["A","B","C","D","E","F","G","H","I"]},
    {numero:14,manzanas:["A","B","C","D","E","F"]},
    {numero:15,manzanas:["A","B","C","D","E"]},
    {numero:16,manzanas:["A","B","C","D","E","F","G"]},
    {numero:17,manzanas:["A","B","C","D","E","F","G"]},
    {numero:18,manzanas:["A","B","C","D","E","F"]},
    {numero:19,manzanas:["A","B","C","D","E","F"]},
    {numero:20,manzanas:["A","B","C","D","E","F","G"]},
    {numero:21,manzanas:["A","B","C","D","E","F","G","H"]},
    {numero:22,manzanas:["A","B","C","D","E","F"]},
    {numero:23,manzanas:["A","B","C","D","E","F"]},
    {numero:24,manzanas:["A","B","C","D","E"]},
    {numero:25,manzanas:["A","B","C","D","E","F"]},
    {numero:26,manzanas:["A","B","C","D","E","F","G"]},
    {numero:27,manzanas:["A","B","C","D","E","F","G"]},
    {numero:28,manzanas:["A","B","C","D","E","F"]},
    {numero:29,manzanas:["A","B","C","D","E"]},
    {numero:30,manzanas:["A","B","C","D","E","F","G","H"]},
    {numero:31,manzanas:["A","B","C","D","E","F","G","H"]},
    {numero:32,manzanas:["A","B","C","D","E","F"]}
];

const grid=document.getElementById("territoriosGrid");
const manzanasSection=document.getElementById("manzanasSection");
const formSection=document.getElementById("formSection");
let territorioSeleccionado=null;

function renderTarjetas(filtro=""){
    grid.innerHTML="";
    territorios.filter(t=>t.numero.toString().includes(filtro)).forEach(t=>{
        const card=document.createElement("div");
        card.className="card";
        card.textContent=`Territorio ${t.numero}`;
        card.onclick=()=>abrirTerritorio(t);
        grid.appendChild(card);
    });
}

renderTarjetas();

document.getElementById("searchInput").addEventListener("input",e=>{
    renderTarjetas(e.target.value);
});

function abrirTerritorio(t){
    territorioSeleccionado=t;
    grid.style.display="none";
    document.getElementById("searchInput").style.display="none";
    manzanasSection.style.display="block";
    formSection.style.display="block";

    manzanasSection.innerHTML=`<h2>Territorio ${t.numero}</h2>`;
    t.manzanas.forEach(m=>{
        const div=document.createElement("div");
        div.className="manzana";
        div.textContent=`Manzana ${m}`;
        div.onclick=()=>div.classList.toggle("checked");
        manzanasSection.appendChild(div);
    });

    const volverBtn=document.createElement("button");
    volverBtn.className="btn volver";
    volverBtn.textContent="⬅️ Volver a territorios";
    volverBtn.onclick=volverTerritorios;
    manzanasSection.appendChild(volverBtn);

    window.scrollTo({top:0,behavior:'smooth'});
}

function volverTerritorios(){
    manzanasSection.style.display="none";
    formSection.style.display="none";
    grid.style.display="grid";
    document.getElementById("searchInput").style.display="block";
    renderTarjetas();
}

function guardarReporte(){
    const nombre=document.getElementById("nombreHermano").value.trim();
    const observaciones=document.getElementById("observaciones").value.trim();
    if(!nombre){alert("Por favor ingrese su nombre.");return;}

    const manzanasDivs=manzanasSection.querySelectorAll(".manzana");
    const hechas=[],pendientes=[];
    manzanasDivs.forEach(div=>{
        const letra=div.textContent.replace("Manzana ","");
        if(div.classList.contains("checked")) hechas.push(letra);
        else pendientes.push(letra);
    });

    const fecha=new Date().toLocaleDateString();
    const reporte={fecha,nombre,territorio:territorioSeleccionado.numero,hechas,pendientes,observaciones};

    const reportesGuardados=JSON.parse(localStorage.getItem("reportes")||"[]");
    reportesGuardados.push(reporte);
    localStorage.setItem("reportes",JSON.stringify(reportesGuardados));

    alert("✅ Informe guardado correctamente.");
    volverTerritorios();
    document.getElementById("nombreHermano").value="";
    document.getElementById("observaciones").value="";
}
</script>

</body>
</html>