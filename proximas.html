<script type="module">
import { db, ref, onValue } from "./firebase.js";

const lista = document.getElementById("listaPendientes");

// LEEMOS LOS REPORTES YA EXISTENTES
const reportesRef = ref(db, "reportes");

onValue(reportesRef, snap => {
  lista.innerHTML = "";
  const datos = snap.val();

  if (!datos) {
    lista.innerHTML = "<p style='color:#666'>No hay reportes cargados.</p>";
    return;
  }

  let encontrados = 0;

  Object.values(datos).forEach(reporte => {

    // SOLO MOSTRAR LOS QUE TIENEN PENDIENTES
    if (reporte.pendientes && reporte.pendientes.length > 0) {

      encontrados++;

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <div><strong>Territorio ${reporte.territorio}</strong></div>
        <div>Pendientes:
          <span class="pend">${reporte.pendientes.join(", ")}</span>
        </div>
        <div>Conductor: ${reporte.conductor || "-"}</div>
        <div>Fecha: ${reporte.fecha || "-"}</div>
      `;

      lista.appendChild(card);
    }

  });

  if (encontrados === 0) {
    lista.innerHTML = "<p style='color:#666'>No hay territorios pendientes.</p>";
  }
});
</script>