<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>App de Territorios</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #f4f8f4;
    }

    header {
        background: #2d6a4f;
        padding: 15px;
        color: white;
        text-align: center;
        font-size: 22px;
        font-weight: bold;
    }

    .container {
        margin: 20px;
    }

    /* Tarjetas del Dashboard */
    .card {
        background: white;
        padding: 20px;
        margin: 15px 0;
        border-radius: 12px;
        box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        cursor: pointer;
        transition: 0.2s;
        font-size: 18px;
        font-weight: bold;
    }
    .card:hover {
        background: #eaf4ea;
    }

    /* Vista oculta */
    .hidden {
        display: none;
    }

    /* Formularios */
    label {
        font-weight: bold;
        margin-top: 10px;
        display: block;
    }
    select, input {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        border-radius: 8px;
        border: 1px solid #aaa;
        font-size: 16px;
    }
    button {
        background: #2d6a4f;
        color: white;
        padding: 12px;
        border: none;
        width: 100%;
        font-size: 18px;
        margin-top: 20px;
        border-radius: 10px;
        cursor: pointer;
    }
    button:hover {
        background: #22543d;
    }

    .back-btn {
        margin-top: 25px;
        background: #555;
    }

    /* Tabla reportes */
    table {
        width: 100%;
        background: white;
        margin-top: 20px;
        border-collapse: collapse;
        border-radius: 10px;
        overflow: hidden;
    }
    th, td {
        padding: 12px;
        border-bottom: 1px solid #e1e1e1;
    }
    th {
        background: #2d6a4f;
        color: white;
    }
</style>
</head>

<body>

<header>Departamento de Territorio</header>

<div class="container">

    <!-- Dashboard -->
    <div id="menu-principal">
        <div class="card" onclick="abrirReportar()">ðŸ“‹ Reportar PredicaciÃ³n</div>
        <div class="card" onclick="abrirReportes()">ðŸ“‘ Ver Reportes</div>
    </div>

    <!-- Reportar predicaciÃ³n -->
    <div id="pantalla-reportar" class="hidden">

        <label>Territorio</label>
        <select id="territorio" onchange="cargarManzanas()">
            <option value="">Seleccionar...</option>
        </select>

        <label>Manzana</label>
        <select id="manzana">
            <option value="">Seleccionar...</option>
        </select>

        <label>Predicador</label>
        <input type="text" id="predicador" placeholder="Nombre del conductor">

        <label>Fecha</label>
        <input type="date" id="fecha">

        <button onclick="guardarReporte()">Guardar Reporte</button>
        <button class="back-btn" onclick="volver()">Volver</button>
    </div>

    <!-- Listado de reportes -->
    <div id="pantalla-reportes" class="hidden">
        <h2>Reportes Realizados</h2>
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Territorio</th>
                    <th>Manzana</th>
                    <th>Predicador</th>
                </tr>
            </thead>
            <tbody id="tabla-reportes"></tbody>
        </table>

        <button class="back-btn" onclick="volver()">Volver</button>
    </div>

</div>

<script>
// =========================
// DATOS DE LOS TERRITORIOS
// =========================

const territorios = {
    1: 4,
    2: 4,
    3: 4,
    4: 5,
    5: 8,
    6: 6,
    7: 6,
    8: 6,
    9: 8,
    10: 6,
    11: 8,
    12: 7,
    13: 4,
    14: 8,
    15: 6,
    16: 6,
    17: 4,
    18: 6,
    19: 4,
    20: 4,
    21: 5,
    22: 4,
    23: 4,
    24: 4,
    25: 4,
    26: 4,
    27: 4,
    28: 6,
    29: 4,
    30: 4,
    31: 5,
    32: 6
};

// cargar territorios en el select
let territorioSelect = document.getElementById("territorio");
Object.keys(territorios).forEach(num => {
    let op = document.createElement("option");
    op.value = num;
    op.textContent = "Territorio " + num;
    territorioSelect.appendChild(op);
});

// =========================
// FUNCIONES DE LA APP
// =========================

function abrirReportar() {
    document.getElementById("menu-principal").classList.add("hidden");
    document.getElementById("pantalla-reportar").classList.remove("hidden");
}

function abrirReportes() {
    document.getElementById("menu-principal").classList.add("hidden");
    document.getElementById("pantalla-reportes").classList.remove("hidden");
    cargarTabla();
}

function volver() {
    document.getElementById("pantalla-reportar").classList.add("hidden");
    document.getElementById("pantalla-reportes").classList.add("hidden");
    document.getElementById("menu-principal").classList.remove("hidden");
}

function cargarManzanas() {
    let territorio = document.getElementById("territorio").value;
    let manzanaSelect = document.getElementById("manzana");

    manzanaSelect.innerHTML = `<option value="">Seleccionar...</option>`;

    if (territorio !== "") {
        let cantidad = territorios[territorio];
        for (let i = 1; i <= cantidad; i++) {
            let op = document.createElement("option");
            op.value = i;
            op.textContent = "Manzana " + i;
            manzanaSelect.appendChild(op);
        }
    }
}

// =========================
// GUARDAR REPORTE
// =========================

function guardarReporte() {
    let territorio = document.getElementById("territorio").value;
    let manzana = document.getElementById("manzana").value;
    let predicador = document.getElementById("predicador").value;
    let fecha = document.getElementById("fecha").value;

    if (!territorio || !manzana || !predicador || !fecha) {
        alert("Por favor complete todos los campos.");
        return;
    }

    let reporte = { territorio, manzana, predicador, fecha };

    // guardar en localStorage
    let lista = JSON.parse(localStorage.getItem("reportes")) || [];
    lista.push(reporte);
    localStorage.setItem("reportes", JSON.stringify(lista));

    alert("Reporte guardado correctamente.");

    // limpiar
    document.getElementById("territorio").value = "";
    document.getElementById("manzana").innerHTML = `<option value="">Seleccionar...</option>`;
    document.getElementById("predicador").value = "";
    document.getElementById("fecha").value = "";
}

// =========================
// MOSTRAR TABLA DE REPORTES
// =========================

function cargarTabla() {
    let lista = JSON.parse(localStorage.getItem("reportes")) || [];
    let tabla = document.getElementById("tabla-reportes");
    tabla.innerHTML = "";

    lista.forEach(r => {
        let tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${r.fecha}</td>
            <td>${r.territorio}</td>
            <td>${r.manzana}</td>
            <td>${r.predicador}</td>
        `;
        tabla.appendChild(tr);
    });
}
</script>

</body>
</html>
