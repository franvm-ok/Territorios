<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Departamento de Territorio ‚Äî Dashboard</title>

<!-- Estilos: verde moderno accesible, tipograf√≠as grandes y botones adaptados para personas mayores -->
<style>
  :root{
    --bg: #eef7ee;              /* fondo claro accesible */
    --panel: #ffffff;           /* tarjetas / paneles */
    --green: #4e8f6b;          /* verde principal (accesible) */
    --green-dark: #35503b;     /* verde oscuro */
    --muted: #6b7a6a;
    --card-shadow: 0 8px 20px rgba(34,64,44,0.08);
    --radius: 16px;
    --gap: 18px;
    --ui-size: 18px;           /* base para inputs/buttons */
    --big-size: 20px;          /* textos grandes para adultos mayores */
  }

  /* Dark theme overrides (applied if body.classList contains 'dark' or user chooses) */
  body.dark {
    --bg: #0f1410;
    --panel: #161915;
    --green: #4e8f6b; /* keep brand accent */
    --green-dark: #6aa87a;
    --muted: #9aa79a;
    --card-shadow: 0 10px 28px rgba(0,0,0,0.6);
  }

  html,body{height:100%;margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:var(--green-dark);font-size:16px;}
  .wrap{max-width:1100px;margin:18px auto;padding:0 16px;}

  /* header (minimalista, top-right controls) */
  header{
    background:linear-gradient(180deg, #57a07b 0%, var(--green) 100%);
    color:white;padding:18px 16px;border-radius:12px;position:relative;
    box-shadow: 0 4px 12px rgba(35,80,50,0.10);
  }
  .header-inner{display:flex;align-items:center;justify-content:center;gap:8px;flex-direction:column}
  .title-main{font-size:26px;font-weight:800;line-height:1}
  .title-sub{font-size:14px;opacity:0.95;margin-top:6px}

  /* top minimal controls (right) */
  .top-row {
    position:absolute; right:14px; top:12px;
    display:flex; gap:8px; align-items:center;
  }
  .top-btn{
    background:var(--panel); color:var(--green-dark); border-radius:10px;
    padding:8px 12px; font-weight:700; font-size:14px; border:1px solid rgba(34,50,40,0.06);
    box-shadow: var(--card-shadow); cursor:pointer;
  }
  .icon-btn {
    width:42px; height:42px; border-radius:10px; display:flex; align-items:center; justify-content:center;
    background:var(--panel); box-shadow:var(--card-shadow); cursor:pointer; border:1px solid rgba(34,50,40,0.06); font-size:15px;
  }

  /* search */
  .search-wrap{display:flex;justify-content:center;margin-top:18px;margin-bottom:16px}
  .search-input{
    width:100%; max-width:700px; padding:14px 18px; border-radius:14px; border:1px solid rgba(34,50,40,0.06);
    font-size:var(--big-size); box-shadow: 0 6px 18px rgba(34,64,44,0.06); background:var(--panel);
    outline:none;
  }

  /* cards grid */
  .cards{
    display:grid; gap:var(--gap);
    grid-template-columns: repeat(1, 1fr);
  }
  @media(min-width:520px){ .cards{grid-template-columns: repeat(2, 1fr);} }
  @media(min-width:900px){ .cards{grid-template-columns: repeat(3, 1fr);} }

  .card{
    background:var(--panel); border-radius:var(--radius); padding:26px; text-align:center; min-height:128px;
    display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px;
    box-shadow:var(--card-shadow); border:1px solid rgba(34,50,40,0.04); cursor:pointer; transition:transform .12s ease;
    user-select:none;
  }
  .card:active{ transform:scale(0.97); box-shadow: 0 4px 12px rgba(0,0,0,0.06) }
  .card .icon{ width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center;
    background: linear-gradient(180deg, rgba(78,143,107,0.12), rgba(78,143,107,0.06)); font-size:34px; color:var(--green-dark); }
  .card .label{ font-size:18px; font-weight:800; color:var(--green-dark); text-align:center;}
  .card .hint{ font-size:14px; color:var(--muted) }

  /* footer and help */
  .help-block{ margin-top:28px; text-align:center; }
  .help-btn{ background:var(--green); color:white; padding:14px 22px; border-radius:14px; font-weight:800; font-size:18px; border:none; cursor:pointer; box-shadow:var(--card-shadow) }
  footer{ margin:30px 0 50px 0; text-align:center; color:var(--muted); font-size:14px }

  /* small responsive tweaks */
  @media(max-width:420px){
    .top-row{right:8px;top:8px}
    .search-input{max-width:95%}
    .card{padding:18px; min-height:110px}
    .card .icon{width:56px;height:56px;font-size:30px}
  }

  /* results panel for search */
  .results{ max-width:900px; margin:12px auto 18px auto; padding:10px; border-radius:12px; background:var(--panel); box-shadow:var(--card-shadow) }
  .result-item{ padding:10px; border-bottom:1px solid rgba(34,50,40,0.04); display:flex; justify-content:space-between; gap:12px; align-items:center }
  .result-link{ color:var(--green-dark); font-weight:700; font-size:16px; text-decoration:none }
  .result-meta{ color:var(--muted); font-size:13px }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <div style="display:flex;align-items:center;gap:10px">
      <div class="title-main">üè† Departamento de Territorio</div>
    </div>
    <div class="title-sub">Congregaci√≥n Cuatro Plazas</div>
  </div>

  <!-- top minimal controls -->
  <div class="top-row" aria-hidden="false">
    <!-- language -->
    <div id="langBtn" class="icon-btn" title="Idioma" aria-label="Cambiar idioma">ES</div>
    <!-- settings -->
    <div id="settingsBtn" class="icon-btn" title="Ajustes" aria-label="Ajustes">‚öôÔ∏è</div>
    <!-- login -->
    <button id="loginBtn" class="top-btn" aria-label="Iniciar sesi√≥n">Iniciar sesi√≥n</button>
  </div>
</header>

<main class="wrap" role="main">

  <!-- search -->
  <div class="search-wrap" aria-label="Buscar en la app">
    <input id="searchInput" class="search-input" type="search" placeholder="Buscar (territorio, manzana, conductor, anuncio)..." aria-label="Buscar">
  </div>

  <!-- resultados de b√∫squeda -->
  <div id="searchResults" class="results" style="display:none" aria-live="polite"></div>

  <!-- DASHBOARD: cada tarjeta abre su propia p√°gina -->
  <section id="dashboard">
    <h2 style="text-align:center;margin:6px 0 6px 0;font-size:20px;color:var(--green-dark)">Bienvenido ‚Äî Elija una acci√≥n</h2>
    <p style="text-align:center;color:var(--muted);margin-top:0;margin-bottom:12px">Interfaz clara y botones grandes ‚Äî pensada para adultos mayores.</p>

    <div class="cards" role="list">
      <a class="card" href="reportar-territorio.html" role="listitem" aria-label="Reportar territorio">
        <div class="icon" aria-hidden="true">üìå</div>
        <div class="label" data-i18n="reportar_territorio">Reportar Territorio</div>
        <div class="hint" data-i18n="hint_territorios">32 territorios y sus manzanas</div>
      </a>

      <a class="card" href="tablero-anuncios.html" role="listitem" aria-label="Tablero de anuncios">
        <div class="icon" aria-hidden="true">üì£</div>
        <div class="label" data-i18n="tablero_anuncios">Tablero de Anuncios</div>
        <div class="hint" data-i18n="hint_anuncios">Sube avisos en PDF</div>
      </a>

      <a class="card" href="mapa.html" role="listitem" aria-label="Mapa">
        <div class="icon" aria-hidden="true">üó∫Ô∏è</div>
        <div class="label" data-i18n="mapa">Mapa</div>
        <div class="hint" data-i18n="hint_mapa">Ver ubicaci√≥n y zonas</div>
      </a>

      <a class="card" href="reportes.html" role="listitem" aria-label="Reportes">
        <div class="icon" aria-hidden="true">üìë</div>
        <div class="label" data-i18n="reportes">Reportes</div>
        <div class="hint" data-i18n="hint_reportes">Historial y exportaci√≥n</div>
      </a>

      <a class="card" href="estadisticas.html" role="listitem" aria-label="Estad√≠sticas">
        <div class="icon" aria-hidden="true">üìä</div>
        <div class="label" data-i18n="estadisticas">Estad√≠sticas</div>
        <div class="hint" data-i18n="hint_estadisticas">Resumen visual</div>
      </a>
    </div>
  </section>

  <!-- ayuda -->
  <div class="help-block">
    <a href="ayuda.html"><button class="help-btn" aria-label="Necesitas ayuda">‚ùì ¬øNecesit√°s ayuda?</button></a>
  </div>

  <footer>App de Territorios ‚Ä¢ Compatible Android / iOS / Tablet / PC</footer>
</main>

<!-- small JS: traducci√≥n, search global, theme respect, top controls -->
<script>
  // Keys used by other pages (kept consistent)
  const REPORTS_KEY = 'territorios_reportes_v1';
  const PDF_KEY = 'territorios_pdfs_v1';

  // ---------- THEME: respect system by default, preference in localStorage ----------
  function applyInitialTheme(){
    const saved = localStorage.getItem('theme_preference'); // 'dark'|'light'|null
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (saved === 'dark') document.body.classList.add('dark');
    else if (saved === 'light') document.body.classList.remove('dark');
    else if (prefersDark) document.body.classList.add('dark');
    updateTopButtonsTheme();
  }
  function updateTopButtonsTheme(){
    const btn = document.getElementById('loginBtn');
    if (document.body.classList.contains('dark')){
      btn.style.background = 'transparent';
      btn.style.color = 'white';
      btn.style.border = '1px solid rgba(255,255,255,0.08)';
    } else {
      btn.style.background = 'var(--panel)';
      btn.style.color = 'var(--green-dark)';
      btn.style.border = '1px solid rgba(34,50,40,0.06)';
    }
  }
  applyInitialTheme();

  // ---------- LANGUAGE: simple i18n for index (ES/EN) ----------
  const strings = {
    es: {
      reportar_territorio: 'Reportar Territorio',
      hint_territorios: '32 territorios y sus manzanas',
      tablero_anuncios: 'Tablero de Anuncios',
      hint_anuncios: 'Sube avisos en PDF',
      mapa: 'Mapa',
      hint_mapa: 'Ver ubicaci√≥n y zonas',
      reportes: 'Reportes',
      hint_reportes: 'Historial y exportaci√≥n',
      estadisticas: 'Estad√≠sticas',
      hint_estadisticas: 'Resumen visual',
      welcome_title: 'Bienvenido ‚Äî Elija una acci√≥n',
      welcome_hint: 'Interfaz clara y botones grandes ‚Äî pensada para adultos mayores.',
      search_placeholder: 'Buscar (territorio, manzana, conductor, anuncio)...',
      help_text: '¬øNecesit√°s ayuda?'
    },
    en: {
      reportar_territorio: 'Report Territory',
      hint_territorios: '32 territories and their blocks',
      tablero_anuncios: 'Announcements Board',
      hint_anuncios: 'Upload PDFs for notices',
      mapa: 'Map',
      hint_mapa: 'View location and zones',
      reportes: 'Reports',
      hint_reportes: 'History & export',
      estadisticas: 'Statistics',
      hint_estadisticas: 'Visual summary',
      welcome_title: 'Welcome ‚Äî Choose an action',
      welcome_hint: 'Clear interface and large buttons ‚Äî designed for older users.',
      search_placeholder: 'Search (territory, block, conductor, announcement)...',
      help_text: 'Need help?'
    }
  };

  let currentLang = localStorage.getItem('lang') || 'es';
  const langBtn = document.getElementById('langBtn');

  function applyLang(){
    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      if (strings[currentLang] && strings[currentLang][key]) el.textContent = strings[currentLang][key];
    });
    // titles & placeholders
    document.querySelector('h2') && (document.querySelector('h2').textContent = strings[currentLang].welcome_title);
    document.querySelector('p') && (document.querySelector('p').textContent = strings[currentLang].welcome_hint);
    document.getElementById('searchInput').placeholder = strings[currentLang].search_placeholder;
    document.querySelector('.help-btn') && (document.querySelector('.help-btn').textContent = (currentLang === 'es') ? '‚ùì ¬øNecesit√°s ayuda?' : '‚ùì Need help?');
    langBtn.textContent = currentLang.toUpperCase();
  }
  langBtn.addEventListener('click', ()=>{
    currentLang = (currentLang === 'es') ? 'en' : 'es';
    localStorage.setItem('lang', currentLang);
    applyLang();
  });
  applyLang();

  // ---------- SETTINGS (open configuracion page) ----------
  document.getElementById('settingsBtn').addEventListener('click', ()=> {
    window.location.href = 'configuracion.html';
  });

  // ---------- LOGIN ----------
  document.getElementById('loginBtn').addEventListener('click', ()=> {
    window.location.href = 'login.html';
  });

  // ---------- SEARCH: busca en tarjetas, local reports y pdfs ----------
  const searchInput = document.getElementById('searchInput');
  const searchResults = document.getElementById('searchResults');

  function searchApp(q){
    const ql = q.trim().toLowerCase();
    if (!ql) { searchResults.style.display = 'none'; return; }

    const results = [];

    // 1) Buscar en tarjetas (titulo/hint)
    document.querySelectorAll('.card').forEach(card=>{
      const label = (card.querySelector('.label')?.textContent || '').toLowerCase();
      const hint = (card.querySelector('.hint')?.textContent || '').toLowerCase();
      const href = card.getAttribute('href') || '#';
      if (label.includes(ql) || hint.includes(ql)){
        results.push({type:'page', title: card.querySelector('.label').textContent, meta: card.querySelector('.hint').textContent, href});
      }
    });

    // 2) Buscar en reportes guardados (localStorage)
    try {
      const reports = JSON.parse(localStorage.getItem(REPORTS_KEY) || '[]');
      (reports||[]).forEach(r=>{
        const text = `${r.territorio} ${r.manzana} ${r.conductor} ${r.notas}`.toLowerCase();
        if (text.includes(ql)){
          results.push({type:'report', title:`Reporte ‚Äî Territorio ${r.territorio}`, meta: `${r.fecha} ‚Ä¢ Conductor: ${r.conductor}`, href:'reportes.html'});
        }
      });
    } catch(e){}

    // 3) Buscar en PDFs
    try {
      const pdfs = JSON.parse(localStorage.getItem(PDF_KEY) || '[]');
      (pdfs||[]).forEach(p=>{
        if (p.name && p.name.toLowerCase().includes(ql)){
          results.push({type:'pdf', title: p.name, meta: `Anuncio ‚Ä¢ ${new Date(Number(p.id)).toLocaleString()}`, href:'tablero-anuncios.html'});
        }
      });
    } catch(e){}

    // Render results
    if (!results.length){
      searchResults.innerHTML = `<div style="padding:12px;color:var(--muted)">No se encontraron resultados.</div>`;
      searchResults.style.display = 'block';
      return;
    }
    searchResults.innerHTML = results.map(r=>`
      <div class="result-item">
        <a class="result-link" href="${r.href}">${escapeHtml(r.title)}</a>
        <div class="result-meta">${escapeHtml(r.meta || '')}</div>
      </div>
    `).join('');
    searchResults.style.display = 'block';
  }

  searchInput.addEventListener('input', (e)=> searchApp(e.target.value));
  searchInput.addEventListener('keydown', (e)=> { if(e.key==='Escape'){ searchInput.value=''; searchResults.style.display='none'; } });

  // ---------- small helpers ----------
  function escapeHtml(s){ return String(s||'').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

  // ---------- stats update (keeps index informative) ----------
  function updateIndexStats(){
    // (optional: could fill counters in future)
  }
  updateIndexStats();

  // ---------- prepare for offline (service worker stub registration) ----------
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').catch(()=>{/* optional */});
  }
</script>

</body>
</html>
